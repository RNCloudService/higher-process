# 11.功能模型的模式

###### 数据处理程序的设计模式 

处理数据库的程序的设计模式按照“在数据库的哪个部分执行哪种数据处理”进行分类。模式会根据处理的表是“单一表”还是“父子表”而不同。如果是前者，还会根据处理的记录是“单条”还是“多条”而不同。此外，这些记录是被“添加”，“更新”，“删除”还是“参考（读取）”也会有所不同。

| レコードタイプ操作タイプ                  | 追加（Create） | 更新（Update） | 削除（Delete） | 参照（Read） |
| ----------------------------------------- | -------------- | -------------- | -------------- | ------------ |
| 単ーテーブル単ーレコード処理（Single）    | SC             | SU             | SD             | SR           |
| 単一テーブル複数レコード処理（ Multiple） | MC             | MU             | MD             | MR           |
| 親子テーブル処理（ （Family）             | FC             | FU             | FD             | FR           |



![功能模型的模式](https://github.com/RNCloudService/higher-process/blob/main/pic/27.jpg)

使用“sc（Single-Create，单独创建）型”程序，可以根据在面板上输入的d1、d2、d3的值向表T1添加一条记录。用户自己输入识别码d1的值，有些表可能更适合自动设置这个值。

在这种模式中，假设接收现有记录的标识符值作为参数会很方便。根据接收到的识别码值，程序可以读取相应记录的内容并在面板上的各个输入字段中设置“初始值”，从而形成具有“记录复制功能”的程序。用户只需手动修改在面板上显示的值中需要更改的字段即可。尽管在这个例子中只有两个属性字段d2和d3，但在字段较多的表中，这种程序将非常方便使用。此外，如果在添加一条记录后程序不终止，而是保持输入字段清除的状态，继续输入也是一个好策略，这样可以方便地连续注册多条数据。此时，可以通过设置“复制按钮”来重新在面板上设置上一次添加的记录的内容，从而进一步提高使用便利性。

虽然“单表单记录处理”中的“SC型”可能有相当复杂的操作，但其他类型通常对应简单的程序规格。“SU（Single- Update，单独更新）型”是用户更改了由参数值搜索到的记录的属性字段的值，并且更新了该记录。另外，“SD（Single- Delete，单独删除）型”将会删除记录，而“SR（Single-Read，单独读取）型”仅显示搜索结果。

此外，在设计“SC型”或“SU型”时，有一点需要注意，“不应该能够更改引用或父级的属性字段”。



![功能模型的模式](https://github.com/RNCloudService/higher-process/blob/main/pic/28.jpg)

功能就像是“数据库的影子”，如果观察数据库，可以推导出处理它的功能的形式，反之，如果观察功能，也能在一定程度上想象出它所处理的数据库的形态。考虑到面板等功能在设计时本来就是预设为用于特定“业务”场景的，可以理解“商业系统的三个要素（数据，业务，功能）”是如何紧密相关的。尽管它们是相互独立的元素，但它们也具有相互影响的面。

这并不意味着可以通过查看功能就能完全了解数据库的所有细节，或者通过查看数据库就能完全理解所有功能的复杂性。这只是说，这两者之间有一个基本的相互关系和相互影响。

![功能模型的模式](https://github.com/RNCloudService/higher-process/blob/main/pic/29.jpg)



###### 单表多记录处理（MC、MU、MD、MR）

在"MC（Multi-Create，批量添加）型"中，输入项目以列表形式显示。将面板分成两部分，首先在面板上为某些属性项目指定值是一个有效的策略。这样做的原因是，这个值会与在第二个面板中输入的项目一起复制到多个记录中，因此对于几乎相同的值的项目，用户不必在详细信息中指定

"MU（Multi-Update，批量更新）型"顶部的项目是应该列出的记录的“过滤条件（subset criteria）"。过滤条件可以是记录上的任何项目，

"MD（Multi-Delete，批量删除）型"与"MU型"类似。在首个面板中输入过滤条件并按下按钮，将列出满足条件的记录。在该面板上，用户将在他们希望删除的详细记录上打上删除目标标记，然后按下删除按钮。在某些情况下，除了为每一行详细信息设置删除指示按钮外，还可以设置一个按钮来指示删除所有列出的记录，这样更方便。

"MR（Multi-Read，批量读取）型"也类似于"MU型"或"MD型"。然而，列出的详细行不仅仅是为了检查值。每一行详细信息都可以启动一个程序，这个程序带有相应表的标识符作为参数。



###### “启动器类型”的模式

就像“MR类型”或“FR类型”一样，它能启动其他程序。在面板上，除了启动功能的说明以文本形式显示外，还可能排列一些输入项目。包括这些在内，启动器程序会在启动后续功能之前设置所需的参数值。

启动器通常启动的许多功能都被称为“批处理”。原本，“批处理”指的是对数据大量的（批量）一次性处理，但也用来指不涉及用户干预（也就是没有面板输入输出）从头到尾完成的数据处理。相对于此，包含用户干预的面板数据处理被称为“交互式处理”。批处理有许多形式，如“月度结算处理”和“需求量计算处理”，无论是规模还是内容都各不相同。

在MR型或FR型中也需要同样的注意事项。当他们在面板上展示的详细记录中启动一些处理时，这些记录是否能接受这些处理不应由“启动源”来检查，而应由“启动目标”来检查。

例如，假设有一个MR类型的“显示所有客户数据”的功能，并对其详细记录提供了弹出菜单。如果菜单中有“（客户的）删除”选项，那么应该检查是否可以删除该记录的是从中启动的“删除客户数据”，而不是“显示所有客户数据”。因为“删除客户数据”可能会被其他功能启动，如果启动源进行检查，那么每个启动源可能会引起启动条件检查逻辑的冲突。