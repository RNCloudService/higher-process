# 21.输入输出设计的整理方法（2）

###### 账票设计 - 将概览和明细整合 

尽管帐票只针对输出，但它仍作为输入/输出设计的一部分进行设计。设计的要素包括帐票概览和帐票详情。

###### 帐票概览: 

这是所需帐票的清单。它是应制作帐票的清单，且用于估算帐票开发的详细时间表和工时。



###### 帳票一覧

| 项目名       | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| #            | 帐票一览的连续号                                             |
| ID           | 表示帐票的ID                                                 |
| 名称         | 简洁地描述帐票名称。按照共同定义的命名规则进行命名           |
| 帐票分类     | 选择在帐票共通中定义的分类，并描述（如：单票、复票、复合传票） |
| 页大小       | 描述输出的纸张大小                                           |
| 页方向       | 描述输出是竖向还是横向                                       |
| 类型         | 如果事先已经打印，描述帐票的印刷用纸编号，否则描述为普通纸   |
| 主要输出信息 | 描述该帐票输出的主要信息                                     |
| 说明         | 描述帐票的概要                                               |
| 输出功能ID   | 描述从哪个功能输出该帐票，以表示更改时的影响范围             |
| 输出数量     | 描述目标帐票的输出数量、页数和预期输出时间                   |
| 使用时机     | 描述帐票输出的大致时机                                       |
| 打印机类型   | 描述打印机的类型                                             |
| 备注         | 为帐票添加备注，如输出数量的依据等                           |



###### 帐票详情 

帐票详情是用于描述每个帐票的布局和项目设计内容的，与屏幕布局和项目列表有同样的位置关系。

###### i）帐票布局 

根据信息的输出内容，帐票的布局大致可以分为三种类型：单票、复票和复合传票。 

###### 单票：

单票是在一个帐票上打印一条信息的。例如，在款项请求单上，支付信息和账户信息等作为单一的信息被打印出来。

###### 复票：

复票是在一个帐票上打印多条信息的，通常呈现为列表格式。例如，账单明细包含多个使用项目，并作为列表进行打印。

###### 复合传票： 

复合传票是由单票和复票组成的帐票。例如，在账单上，收件人、请求信息、账户信息等作为单一的信息被打印。但对于使用明细，它是以列表的形式构成的，并打印多个页面。这种结合了单票信息和复票信息的帐票，称为复合传票。



###### 帳票項目設計書

| 项目名 | 说明           |
| ------ | -------------- |
| ＃     | 描述连续号     |
| ID     | 描述项目的ID   |
| 名称   | 描述项目的名称 |

| 项目名   | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| 显示内容 | 描述此项目的显示内容、应显示的信息源（如数据库）和计算逻辑。例如，按日期销售额这一项，将从数据库的销售信息中取得的销售金额作为信息源，并按日期累计。 |
| 格式     | 描述帐票项目的类型（如数字、字符串、货币、日期）。此类型应按照帐票通用定义来描述，或描述帐票通用中定义的内容。 |
| 大小     | 描述项目值的位数（数字）或字符数（字符串）。                 |
| 字体指定 | 描述字体类型和大小（如果缩小，则包括其内容），以及显示颜色/背景色。 |
| 格式化   | 描述如何表示数字（如三位一分的逗号分隔）和日期的格式（如YY-MM-DD）。这里也可以描述对齐方式，如右对齐、左对齐，或按照帐票标准定义的内容描述。 |
| 重复     | 如果是重复项目，则标记为○。                                  |
| 级别     | 如果有重复的项目，描述父项目和子项目的关系以级别（=数字）表示。表示级别的习惯是只使用奇数。 |
| 排序顺序 | 如果显示项目有重复，描述决定这些重复的顺序的项目是否为数字（从1开始顺序编号，如果有多个，先按1的项目排序，如果1的项目相同，则按2的项目排序）。 |
| 备注     | 如果有特殊说明的项目，则进行描述。                           |



###### 単票的例

| ＃   | ID       | 名称         | 显示内容                                                     |
| ---- | -------- | ------------ | ------------------------------------------------------------ |
| 1    | PC-10-01 | 账单头部标志 | 从数据库的系统主数据中取得。获取公司标志的文件路径并输出该图像文件。 |
| 2    | PC-10-02 | 说明文       | 从数据库的系统主数据中取得。获取账单说明文并输出该字符串。   |
| 3    | PC-10-03 | 使用年月     | 输出账单处理的输入变量，即使用年份和月份，按照格式进行输出。 |
| 4    | PC-10-04 | 支付金额     | 使用帐单处理的输入变量（用户ID、使用年份和月份）从数据库的使用明细中获取金额并进行总计输出。 |
| 5    | PC-10-05 | 支付日期     | 从数据库的日历中取得。获取支付日期并按照格式输出。           |
| 6    | PC-10-06 | 支付账户     | 使用帐单处理的输入变量（用户ID）从数据库获取用户和账户信息并进行输出。 |
| 7    | PC-10-07 | 账户名义     | 使用帐单处理的输入变量（用户ID）从数据库获取用户和账户名义进行输出。 |

| ＃   | 大小         | 字体指定                | 格式          | 繁复           | 级别       | 排序顺序   | 备注                        |
| ---- | ------------ | ----------------------- | ------------- | -------------- | ---------- | ---------- | --------------------------- |
| 1    | 210x80       | 图片像素                | 全角40文字    | MSゴシック     | 左对齐     | 2          | 文本                        |
| 2    | 全角×4行     | 10pt                    | 全角半角混合  | YYYY年MM月     | 全角5文字  | MSゴシック | 右对齐                      |
| 3    | MM为一位数时 | 用半角空格填充至2个字符 | 3位数逗号分隔 | MSゴシック     | 4          | 货币       | 9位数                       |
| 4    | YYYY年MM月   | DD日                    | 右对齐        | 全角7文字      | MSゴシック | 5          | 字相当于18pt                |
| 5    | MSゴシック   | 全角半角混合            | 6级 文本      | 全角10文字×4行 | 18pt       | 左对齐     | 获取的账户名标题            |
| 6    | 全角10文字   | MSゴシック              | 7级 文本      | (全角空格)     | 18pt       | 左对齐     |                             |
| 7    | 8级 图片     | 210x80                  | 像素          |                |            |            | ※假设帐单标准中已定义货币。 |



###### 复票的例

| ＃   | ID       | 名称         | 显示内容                                                     |
| ---- | -------- | ------------ | ------------------------------------------------------------ |
| 1    | PC-11-01 | 账单头部标志 | 从系统主数据DB中获取。取得公司标志的文件路径，并输出该图像文件。 |
| 2    | PC-11-02 | 利用年月     | 使用输入变量，即使用年和月，按照格式输出。                   |
| 3    |          | 利用明细一览 | 使用输入变量，如用户ID、使用年和月，从DB中获取所有使用明细并循环输出。 |
| 4    | PC-11-03 | 利用明细 月  | 循环项目，显示使用明细的月份。                               |
| 5    | PC-11-04 | 利用明细 日  | 循环项目，显示使用明细的日期。                               |
| 6    | PC-11-05 | 利用内容     | 循环项目，显示使用明细的使用内容。                           |
| 7    | PC-11-06 | 利用金额     | 循环项目，显示使用明细的金额。                               |
| 8    | PC-11-07 | 合计         | 计算使用的总额，并仅在最后一页上显示。                       |
| 9    | PC-11-08 | 页面         | 获取当前账单的页码和前一页的数量，并按格式输出。             |
| 10   | PC-11-08 | 账单尾部标志 | 从系统主数据DB中获取。取得公司说明标志的文件路径，并输出该图像文件。 |

| ＃   | 形式   | 大小          | 字体指定   | 格式                                        | 繁复 | 层级 | 排序     |
| ---- | ------ | ------------- | ---------- | ------------------------------------------- | ---- | ---- | -------- |
| 1    | 图像   | 210x80        | 像素       | 全角半角混合 YYYY年MM月                     |      |      |          |
| 2    | 字符串 | 全角5文字相当 | MSゴシック | MM是1位数的情况下，用半角空格填充至2位。    |      |      |          |
| 3    | 数字   | 2             | MSゴシック | 使用明细月-日顺序，同日的情况下按金额排序。 | O    | 1    | 金额顺序 |
| 4    | 数字   | 2             | MSゴシック | 半角右对齐                                  | O    | 3    |          |
| 5    | 数字   | 2             | MSゴシック | 半角右对齐                                  | O    | 2    |          |
| 6    | 字符串 | 全角12文字    | MSゴシック | 全角左对齐                                  | O    | 3    |          |
| 7    | 货币   | 9位           | MSゴシック | 3位逗号分隔，半角右对齐                     |      | 3    |          |
| 8    | 货币   | 9位           | MSゴシック | 3位逗号分隔，半角右对齐                     |      |      |          |
| 9    | 字符串 | 半角5文字     | MSゴシック | 中央对齐，显示当前页面号/总页数             |      |      |          |
| 10   | 图像   | 210x80        | 像素       |                                             |      |      |          |



###### 复合传票的例

| ID       | 名称         | 显示内容                                                     |
| -------- | ------------ | ------------------------------------------------------------ |
| PC-12-01 | 账单头部标志 | 从系统主数据库中获取公司标志的文件路径，并输出该图像文件。   |
| PC-12-02 | 说明文       | 从系统主数据库中获取账单说明文和信用卡支付日期，并替换说明文中的内容进行输出。 |
| PC-12-03 | 信用卡信息   | 使用输入的用户ID从数据库中输出用户的信用卡信息。             |
| PC-12-04 | 使用年月     | 按照格式输出输入变量中的使用年份和使用月份。                 |
| PC-12-05 | 支付金额     | 使用输入的用户ID、使用年、使用月，从使用明细数据库中计算总金额并输出。 |
| PC-12-06 | 使用明细列表 | 使用输入的用户ID、使用年、使用月，从数据库中获取所有使用明细并循环输出。 |
| PC-12-07 | 使用明细 月  | 循环项，显示使用明细的月份。                                 |
| PC-12-08 | 使用明细 日  | 循环项，显示使用明细的日期。                                 |
| PC-12-09 | 使用内容     | 循环项，显示使用明细的使用内容。                             |
| PC-12-10 | 使用金额     | 循环项，显示使用明细的使用金额。                             |
| PC-12-11 | 合计         | 计算使用明细的总金额并仅在最后一页输出。                     |
| PC-12-12 | 账单尾部标志 | 从系统主数据库中获取公司说明标志的文件路径，并输出该图像文件。 |

| #    | 形式   | 大小     | 字体       | 格式说明                                                   | 繁复级别 | 排序顺序 | 备注   |
| ---- | ------ | -------- | ---------- | ---------------------------------------------------------- | -------- | -------- | ------ |
| 1    | 图片   | 210x80px | -          | -                                                          | -        | -        | -      |
| 2    | 字符串 | -        | MSゴシック | 全角40文字，左对齐                                         | -        | -        | -      |
| 3    | 字符串 | -        | MSゴシック | 全角20文字，信用卡号码，除了最后4位其他用*掩码，带“様”字样 | 3        | -        | -      |
| 4    | 字符串 | -        | MSゴシック | YYYY年MM月，当MM为一位数时，用半角空格填充至2位            | -        | -        | 右对齐 |
| 5    | 货币   | -        | MSゴシック | 9位，3位逗号分隔，带“円”字样                               | -        | -        | 右对齐 |
| 6    | -      | -        | -          | 利用明细按月、日排序，相同日期则按金额排序                 | 1        | -        | -      |
| 7    | 数字   | -        | MSゴシック | 2位，半角，右对齐                                          | 3        | -        | -      |
| 8    | 数字   | -        | MSゴシック | 2位，半角，右对齐                                          | 3        | -        | -      |
| 9    | 字符串 | -        | MSゴシック | 全角12文字，左对齐                                         | 3        | -        | -      |
| 10   | 货币   | -        | MSゴシック | 9位，3位逗号分隔，*掩码                                    | 3        | 9        | 右对齐 |
| 11   | 货币   | -        | MSゴシック | 9位，3位逗号分隔，*掩码                                    | 10       | -        | 右对齐 |
| 12   | 图片   | 210x80px | -          | -                                                          | -        | -        | -      |

在这些例子中，假设报表设计的前提是重复项目少于或等于5（没有翻页）。这样的例子是罕见的，但如果字符串有折叠或数据量有限制，这样的设计是可以的。但它缺乏扩展性，所以像复票的例子那样，需要考虑翻页，并在页面翻转时考虑设计和输出内容。

从报表设计仅仅是输入/输出设计的立场来看，可能在处理详细设计中预处理项目的值，然后将这些项目应用到输出中会更好。